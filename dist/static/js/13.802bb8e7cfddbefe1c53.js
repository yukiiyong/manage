webpackJsonp([13],{"/y4V":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("woOf"),i=s.n(a),n=s("Dd8w"),o=s.n(n),l=s("l/JR"),r={0:"未使用",1:"已过期",2:"已下架",3:"已使用"},c={0:"全场赠券",1:"会员赠券",2:"注册赠券"},u={0:"全场通用",1:"指定商品",2:"指定分类"},d={data:function(){return{list:[{id:"",title:"",activeStatus:0,startDate:"",endDate:"",status:0}],filters:{title:""},secPromotion:{},isEdit:!1,total:0,page:1,listLoading:!1,dialogVisible:!1,statusMap:r,typeMap:c,goodsTypeMap:u}},filters:{filterActiveStatus:function(t){var e=(new Date).getTime();return e>=t.startDate&&e<=t.endDate?"活动进行中":e<t.startDate?"活动未开始":"活动已结束"},createTime:function(t){return new Date(t)}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.listLoading=!0;var e=o()({},this.filters,{page:this.page});Object(l.k)(e).then(function(e){e.success&&(t.listLoading=!1,t.list=e.list,t.total=e.total)}).catch(function(e){t.listLoading=!1,t.$message({type:"danger",message:e})})},resetSearch:function(){this.$refs.form.resetFields()},handleCurrentChange:function(t){this.page=t,this.getList()},handleDelete:function(t,e){var s=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then(function(){s.list.splice(t,1)}),this.getList()},handleAdd:function(t,e){this.dialogVisible=!0,this.isEdit=!1,this.secPromotion=i()({},e)},handleUpdate:function(t){this.dialogVisible=!0,this.isEdit=!0,this.secPromotion=i()({},t)},handleReset:function(){this.$refs.secPromotion.resetFields()},handleSubmit:function(){var t=this;this.$confirm("确定提交？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.secPromotion.startDate=t.formatDate(t.secPromotion.startDate),t.secPromotion.endDate=t.formatDate(t.secPromotion.endDate),t.isEdit?Object(l.p)(t.secPromotion.id,t.secPromotion).then(function(e){e&&e.success&&(t.$message({type:"success",message:"修改成功！"}),t.dialogVisible=!1,t.getList())}):Object(l.d)(t.secPromotion).then(function(e){e&&e.success&&(t.$message({type:"success",message:"创建成功！"}),t.dialogVisible=!1,console.log(t.$options.data().secPromotion),t.getList())})}).catch(function(t){console.log(t)})},formatDate:function(t){var e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e=e.toJSON().substr(0,10).replace(/[T]/g,"")},handleStatusChange:function(t,e){var s=this;this.$confirm("是否修改该状态","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={id:t.id,status:t.status};Object(l.q)(e).then(function(t){t&&t.success?s.$message({type:"success",message:"状态修改成功！"}):s.$message({type:"error",message:t.msg}),s.getList()}).catch(function(t){s.$message({type:"error",message:"修改失败！"+t})})})}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("el-card",{staticClass:"mt20",attrs:{shadow:"never"}},[s("div",{staticClass:"search-tit "},[s("i",{staticClass:"el-icon-search"}),t._v(" "),s("span",[t._v("筛选搜索")]),t._v(" "),s("el-button",{staticClass:"search-btn",attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),s("el-button",{staticClass:"search-btn",attrs:{type:"primary",size:"mini"},on:{click:t.getList}},[t._v("查找")])],1),t._v(" "),s("el-form",{ref:"form",attrs:{model:t.filters,"label-width":"150px"}},[s("el-form-item",{attrs:{label:"活动标题:",prop:"title"}},[s("el-input",{attrs:{placeholder:"请输入活动名称"},model:{value:t.filters.title,callback:function(e){t.$set(t.filters,"title",e)},expression:"filters.title"}})],1)],1)],1),t._v(" "),s("el-card",{staticClass:"mt20",attrs:{shadow:"never"}},[s("div",{staticClass:"tit"},[s("i",{staticClass:"fa fa-file-text-o"}),t._v(" "),s("span",[t._v("数据列表")]),t._v(" "),s("el-button",{staticStyle:{float:"right"},attrs:{size:"mini"},on:{click:t.handleAdd}},[t._v("添加")])],1)]),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{margin:"20px 10px"},attrs:{data:t.list,border:""}},[s("el-table-column",{attrs:{prop:"id",label:"编号",align:"center",width:"100"}}),t._v(" "),s("el-table-column",{attrs:{prop:"title",label:"活动标题",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"activeStatus",label:"活动状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t._f("filterActiveStatus")(e.row)))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"startDate",label:"开始时间",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{prop:"endDate",label:"结束时间",align:"center"}}),t._v(" "),s("el-table-column",{attrs:{label:"上线/下线",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(s){t.handleStatusChange(e.row,e.$index)}},model:{value:e.row.status,callback:function(s){t.$set(e.row,"status",s)},expression:"scope.row.status"}})]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){t.handleUpdate(e.row)}}},[t._v("编辑")]),t._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),s("el-col",{staticClass:"toolbar",attrs:{span:24}},[s("el-pagination",{attrs:{layout:"total, prev, pager, next, jumper",background:"","page-size":15,total:t.total,"current-page":t.page},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),s("el-dialog",{attrs:{visible:t.dialogVisible,title:t.isEdit?"编辑活动":"添加活动"},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("div",[s("el-form",{ref:"secPromotionForm",attrs:{model:t.secPromotion,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"活动标题",prop:"title"}},[s("el-input",{attrs:{placeholder:"请输入活动标题"},model:{value:t.secPromotion.title,callback:function(e){t.$set(t.secPromotion,"title",e)},expression:"secPromotion.title"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"开始时间",prop:"startDate"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"请选择时间"},model:{value:t.secPromotion.startDate,callback:function(e){t.$set(t.secPromotion,"startDate",e)},expression:"secPromotion.startDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"结束时间",prop:"endDate"}},[s("el-date-picker",{attrs:{type:"date",placeholder:"请选择时间"},model:{value:t.secPromotion.endDate,callback:function(e){t.$set(t.secPromotion,"endDate",e)},expression:"secPromotion.endDate"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"上线/下线",prop:"status"}},[s("el-radio-group",{model:{value:t.secPromotion.status,callback:function(e){t.$set(t.secPromotion,"status",e)},expression:"secPromotion.status"}},[s("el-radio",{attrs:{label:1}},[t._v("上线")]),t._v(" "),s("el-radio",{attrs:{label:0}},[t._v("下线")])],1)],1)],1),t._v(" "),s("div",{staticClass:"op-container mt40"},[s("el-button",{on:{click:t.handleReset}},[t._v("重置")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)])],1)},staticRenderFns:[]};var p=s("VU/8")(d,m,!1,function(t){s("sqVK")},"data-v-29cb33a3",null);e.default=p.exports},sqVK:function(t,e){}});
//# sourceMappingURL=13.802bb8e7cfddbefe1c53.js.map